{%extends "dash.html" %}{% load staticfiles%}
{%block title%} Home | Empresas {%endblock%}
{%block head2%}<link href="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.1/css/select2.min.css" rel="stylesheet" />{%endblock%}
{% block navegacion%}
<li><a href="/home/"><i class="fa fa-home"></i></a></li>
<li><a href="/empresas"><i><span>/ Empresas </span></i></a></li>
<li><a href="#"><i><span>/ Editar </span></i></a></li>
{%endblock%}
{% block contenido2 %}
<div class="row">
	<div class="panel panel-default toggle m-t-xs ml20 mr20">
		<div class="panel-heading">
			<h4 class="panel-title"> Complete los siguientes campos para modificar la empresa:</h4>
		</div>
		<div class="panel-body table-responsive" style="overflow: hidden; width: 100%; height: auto;">
			<form class="form-horizontal" method="POST">{%csrf_token%}
				<div class="form-group">
					<label class="col-lg-2 col-md-2 col-xs-2 col-sm-2 control-label required">Nombre:</label>
					<div class="col-lg-5 col-md-5 col-xs-9 col-sm-8">
						<input id="nombre" required title="Este campo es obligatorio" type="text" name="nombre" class="form-control" maxlength="100" placeholder="Nombre de la empresa a registrar" value="{{Empresa.nombre |escape}}">
						<div id="errornombre"></div>
					</div>
				</div>
				<div class="form-group">
					<label class="col-lg-2 col-md-2 col-xs-2 col-sm-2 control-label required">Nit:</label>
					<div class="col-lg-5 col-md-5 col-xs-9 col-sm-8">
						<input id="nit" required title="Este campo es obligatorio" type="text" name="nit" class="form-control" maxlength="20" placeholder="Nit de la empresa a registrar" value="{{Empresa.nit |escape}}">
						<div id="errornit"></div>
					</div>
				</div>
				<div class="form-group">
					<label class="col-lg-2 col-md-2 col-xs-2 col-sm-2 control-label required">Página web:</label>
					<div class="col-lg-5 col-md-5 col-xs-9 col-sm-8">
						<input  required title="Este campo es obligatorio" type="text" name="pagina" class="form-control" maxlength="1000" placeholder="Página de redicrección al terminar una encuesta" value="{{Empresa.pagina |escape}}">
					</div>
				</div>
				<div class="form-group">
					<label class="col-lg-2 col-md-2 col-xs-2 col-sm-2 control-label required">Número de empleados:</label>
					<div class="col-lg-5 col-md-5 col-xs-9 col-sm-8">
						<input  required title="Este campo es obligatorio" type="number" name="num_empleados" class="form-control" min="1" max="99999999" placeholder="Número aproximado de empleados" value="{{Empresa.num_empleados |escape}}">
					</div>
				</div>
				<div class="form-group">
					<label class="col-lg-2 col-md-2 col-xs-2 col-sm-2 control-label required">Sector económico:</label>
					<div class="col-lg-5 col-md-5 col-xs-9 col-sm-8">
						<select class="select2 form-control" name="sector" required titlle="Este campo es obligatorio">
							<option {%ifequal "Administración" Empresa.sector %}selected{%endifequal%} value="Administración">Administración</option>
							<option {%ifequal "Agrícola" Empresa.sector %}selected{%endifequal%} value="Agrícola">Agrícola</option>
							<option {%ifequal "Comercial" Empresa.sector %}selected{%endifequal%} value="Comercial">Comercial</option>
							<option {%ifequal "Comunicaciones" Empresa.sector %}selected{%endifequal%} value="Comunicaciones">Comunicaciones</option>
							<option {%ifequal "Construcción" Empresa.sector %}selected{%endifequal%} value="Construcción">Construcción</option>
							<option {%ifequal "Consultoría" Empresa.sector %}selected{%endifequal%} value="Consultoría">Consultoría</option>
							<option {%ifequal "Educativo" Empresa.sector %}selected{%endifequal%} value="Educativo">Educativo</option>
							<option {%ifequal "Energético" Empresa.sector %}selected{%endifequal%} value="Energético">Energético</option>
							<option {%ifequal "Entidad Estatal" Empresa.sector %}selected{%endifequal%} value="Entidad Estatal">Entidad Estatal</option>
							<option {%ifequal "Financiero" Empresa.sector %}selected{%endifequal%} value="Financiero">Financiero</option>
							<option {%ifequal "Forestal" Empresa.sector %}selected{%endifequal%} value="Forestal">Forestal</option>
							<option {%ifequal "Ganadero" Empresa.sector %}selected{%endifequal%} value="Ganadero">Ganadero</option>
							<option {%ifequal "Industrial" Empresa.sector %}selected{%endifequal%} value="Industrial">Industrial</option>
							<option {%ifequal "Minero" Empresa.sector %}selected{%endifequal%} value="Minero">Minero</option>
							<option {%ifequal "Pesquero" Empresa.sector %}selected{%endifequal%} value="Pesquero">Pesquero</option>
							<option {%ifequal "Sanitario" Empresa.sector %}selected{%endifequal%} value="Sanitario">Sanitario</option>
							<option {%ifequal "Servicios" Empresa.sector %}selected{%endifequal%} value="Servicios">Servicios</option>
							<option {%ifequal "Software y tecnologías de la información" Empresa.sector %}selected{%endifequal%} value="Software y tecnologías de la información">Software y tecnologías de la información</option>
							<option {%ifequal "Solidario" Empresa.sector %}selected{%endifequal%} value="Solidario">Solidario</option>
							<option {%ifequal "Transportes" Empresa.sector %}selected{%endifequal%} value="Transportes">Transportes</option>
							<option {%ifequal "Turístico" Empresa.sector %}selected{%endifequal%} value="Turístico">Turístico</option>
						</select>
					</div>
				</div>
				<div class="form-group">
					<label class="col-lg-2 col-md-2 col-sm-2 col-xs-2 control-label required">País:</label>
					<div class="col-lg-5 col-md-5 col-sm-9 col-xs-8">
						<select id="country" name="pais" class="select2 form-control" required title="Este campo es obligatorio"></select>
					</div>
				</div>
				<div class="form-group">
					<label class="col-lg-2 col-md-2 col-sm-2 col-xs-2 control-label required">Departamento:</label>
					<div class="col-lg-5 col-md-5 col-sm-9 col-xs-8">
						<select  id="state" name="departamento" class="select2 form-control" required title="Este campo es obligatorio"></select>
					</div>
				</div>
				<div class="container-fluid"><button type="submit" class="btn btn-primary pull-right m-t"><i class="fa fa-save"></i> Actualizar Empresa</button></div>
			</form>
		</div>
	</div>
</div>
{% endblock %}

{% block scripts%}
<script src="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.1/js/select2.min.js"></script>
<script type="text/javascript" src="{% static 'js/plugins/ciudades/ciudades.min.js' %}"></script>
<script >populateCountries("country", "state");</script>
<script type="text/javascript" src="{% static 'js/plugins/ciudades/ciudades.min.js' %}"></script>
<script >
function populateStates2(countryElementId, stateElementId) {
	var selectedCountryIndex = document.getElementById(countryElementId).selectedIndex;
    var stateElement = document.getElementById(stateElementId);
    stateElement.length = 0;
    var state_arr = s_a[selectedCountryIndex+1].split("|");
    for (var i = 0; i <= state_arr.length; i++) {
        stateElement.options[stateElement.length] = new Option(state_arr[i], state_arr[i]);
		if('{{Empresa.departamento}}'==state_arr[i]){
			stateElement.selectedIndex = i;
		}
    }
}

function populateCountries2(countryElementId, stateElementId) {
	var countryElement = document.getElementById(countryElementId);
	countryElement.length = 0;
	countryElement.options[0] = new Option('Seleccione el pais', '0');
    for (var i = 1; i <= country_arr.length +1; i++) {
        countryElement.options[countryElement.length] = new Option(country_arr[i], country_arr[i]);
		if('{{Empresa.pais}}'==country_arr[i]){
			countryElement.selectedIndex = i;
		}
    }
	populateStates2("country", "state");
    if (stateElementId) {
        countryElement.onchange = function () {
            populateStates2(countryElementId, stateElementId);
			$("#state").select2("destroy");
			$("#state").select2();
        };
    }
}
populateCountries2("country", "state");
</script>
<script>$('.select2').select2()</script>
<script>$(document).ready(function(){var nombres =[],$nombre = $("#nombre"),nits =[],$nit = $("#nit"),$errornombre=$('#errornombre'),	$errornit=$('#errornit');{% for i in Empresas%}nombres.push('{{i.nombre |escape|safe}}');nits.push('{{i.nit |escape|safe}}');{% endfor %}nnombres=nombres.length;$nombre.keyup(function(){ban = false;for (var i = 0; i < nnombres; i++) {if($nombre.val() == nombres[i]){$errornombre.html('<span style="color:#cd1e21">Este nombre ya se encuentra registrado.</span>');ban = true;}if(! ban){$errornombre.html('');}}$nombre.val});nnits=nits.length;$nit.keyup(function(){ban2 = false;for (var i = 0; i < nnits; i++) {if($nit.val() == nits[i]){$errornit.html('<span style="color:#cd1e21">Este nit ya se encuentra registrado.</span>');ban2 = true;}if(! ban2){$errornit.html('');}}$nombre.val});});</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.14.0/jquery.validate.min.js"></script>
<script type="text/javascript">$('form').validate({ errorPlacement:function(error,element){	error.appendTo(element.parent());}	});</script>
{% endblock %}
