{% extends "dash.html" %}
{% load staticfiles%}
{% block title %} Datos para el proyecto {% endblock %}
{% block head2%}
<link href="{% static 'css/plugins/chosen/chosen.min.css' %}" rel="stylesheet">
<link href="{% static 'css/plugins/summernote/summernote.min.css' %}" rel="stylesheet">
<style>.chosen-container-single .chosen-single {border-radius:0%;}div.note-editor{height: 100%;width: 100%;border: 1px solid #dedede;margin-bottom: 10px;}</style>
{% endblock %}
{% block contenido2 %}
<div class="row">
<div class="m-l m-r row wrapper border-bottom white-bg page-heading">
	<div class="col-lg-12">
		<h2>Agregar proyecto</h2>
		<ol class="breadcrumb">
			<li ><a href="/home/"><i class="fa fa-home"></i> Home</a>
			</li>
			<li>Proyectos</li>
		</ol>
	</div>
</div>
<div class="m-t col-lg-12">
	<div class="ibox float-e-margins">
		<div class="ibox-title">
			<h5 class="m-r-xs">Complete los campos correctamente:</h5>
			<div class="ibox-tools">
				<a class="collapse-link">
					<i class="fa fa-chevron-up"></i>
				</a>
			</div>
		</div>
		<div class="ibox-content">
		{%if not Empresas%}<p> Recuerde crear la <a href="/empresa/nueva/" class="LINK">EMPRESA</a> {%if Permisos.cre_usuarios %}y los <a href="/usuario/nuevo/" class="LINK">USUARIOS</a>{%endif%} primero para ahorrar trabajo.{%endif%}
		<form method="POST" class="form-horizontal" enctype="multipart/form-data">{% csrf_token %}
			<div class="row">
				<div class="form-group">
					<label class="col-lg-3 col-md-3 col-xs-3 col-sm-3 control-label required">Empresa:</label>
					<div class="col-lg-5 col-md-5 col-xs-8 col-sm-8">
						<select class="chosen-select form-control" name="empresa" required>
							<option value="">Seleccione una empresa</option>
							{%for i in Empresas%}<option value="{{i.id}}">{{i}}</option>{%endfor%}
						</select>
					</div>
				</div>
				<div class="form-group">
					<label class="col-lg-3 col-md-3 col-sm-3 col-xs-3 control-label required">Nombre de proyecto:</label>
					<div class="col-lg-5 col-md-5 col-sm-9 col-xs-8" >
						<input id="nombre" class="form-control" placeholder="Nombre que identifica el proyecto" name="nombre"  type="text" required>
						<div id="error"></div>
					</div>
				</div>
				<div class="form-group">
					<label class="col-lg-3 col-md-3 col-sm-3 col-xs-3 control-label required">Tipo de encuesta:</label>
					<div class="col-lg-5 col-md-5 col-sm-9 col-xs-8" >
						<select class="chosen-select form-control" name="tipo">
							<option value="Completa">Encuesta Completa</option>
							<option value="Fragmentada">Encuesta Fragmentada</option>
							<option value="Externa">Encuesta Externa</option>
						</select>
					</div>
				</div>
				<div class="form-group">
					<label class="col-lg-3 col-md-3 col-sm-3 col-xs-3 control-label required">Título de la encuesta:</label>
					<div class="col-lg-5 col-md-5 col-sm-9 col-xs-8" >
						<input class="form-control" placeholder="Título que aparecerá en la encuesta" name="tit_encuesta"  type="text" required maxlength="255">
					</div>
				</div>
				<div class="form-group">
					<label class="col-lg-3 col-md-3 col-sm-3 col-xs-3 control-label required">Introducción a la encuesta:</label>
					<div class="col-lg-8 col-md-8 col-sm-9 col-xs-8" >
						<div id="summernote1" class="summernote"><i>Este texto aparecerá en la introducción de la encuesta web </i><b>(requerido)</b></div>
					</div>
				</div>
				<input type="hidden" value="" name="int_encuesta"/>
				<div class="form-group">
					<label class="col-lg-3 col-md-3 col-sm-3 col-xs-3 control-label required">Cuerpo del correo:</label>
					<div class="col-lg-8 col-md-8 col-sm-9 col-xs-8" >
						<div id="summernote3" class="summernote"><i>Este es el texto que llegará al correo para seguir a la encuesta </i><b>(requerido)</b></div>
					</div>
				</div>
				<input type="hidden" value="" name="cue_correo" />
				<div class="form-group">
					<label class="col-lg-3 col-md-3 col-sm-3 col-xs-3 control-label required">Logo para correo:</label>
					<div class="col-lg-8 col-md-8 col-sm-9 col-xs-8" >
						<input id ="logo" name="logo" type="file" required>
					</div>
				</div>
				<div class="form-group">
					<label class="col-lg-3 col-md-3 col-sm-3 col-xs-3 control-label norequired">Logo para encuesta web:</label>
					<div class="col-lg-8 col-md-8 col-sm-9 col-xs-8" >
						<input id ="logoenc" name="logoenc" type="file" >
					</div>
				</div>
				<div class="form-group">
					<label class="col-lg-3 col-md-3 col-sm-3 col-xs-3 control-label norequired">Usuarios asociados:</label>
					<div class="col-lg-5 col-md-5 col-sm-9 col-xs-8" >
						<select class="chosen-select form-control" multiple name="usuarios">
							{%for i in Usuarios%}<option value="{{i.usuario.id}}">{{i.usuario.first_name|capfirst|escape}} {{i.usuario.last_name|capfirst|escape}}</option>{%endfor%}
						</select>
					</div>
				</div>
				<div class="form-group">
					<label class="col-lg-3 col-md-3 col-sm-3 col-xs-3 control-label norequired">Variable opcional 1:</label>
					<div class="col-lg-5 col-md-5 col-sm-9 col-xs-8" >
						<input class="form-control" placeholder="Nombre de la variable 1 de los participantes" name="opcional1"  type="text" maxlength="100">
					</div>
				</div>
				<div class="form-group">
					<label class="col-lg-3 col-md-3 col-sm-3 col-xs-3 control-label norequired">Variable opcional 2:</label>
					<div class="col-lg-5 col-md-5 col-sm-9 col-xs-8" >
						<input class="form-control" placeholder="Nombre de la variable 2 de los participantes" name="opcional2"  type="text" maxlength="100">
					</div>
				</div>
				<div class="form-group">
					<label class="col-lg-3 col-md-3 col-sm-3 col-xs-3 control-label norequired">Variable opcional 3:</label>
					<div class="col-lg-5 col-md-5 col-sm-9 col-xs-8" >
						<input class="form-control" placeholder="Nombre de la variable 3 de los participantes" name="opcional3"  type="text" maxlength="100">
					</div>
				</div>
				<div class="form-group">
					<label class="col-lg-3 col-md-3 col-sm-3 col-xs-3 control-label norequired">Variable opcional 4:</label>
					<div class="col-lg-5 col-md-5 col-sm-9 col-xs-8" >
						<input class="form-control" placeholder="Nombre de la variable 4 de los participantes" name="opcional4"  type="text" maxlength="100">
					</div>
				</div>
				<div class="form-group">
					<label class="col-lg-3 col-md-3 col-sm-3 col-xs-3 control-label norequired">Variable opcional 5:</label>
					<div class="col-lg-5 col-md-5 col-sm-9 col-xs-8" >
						<input class="form-control" placeholder="Nombre de la variable 5 de los participantes" name="opcional5"  type="text" maxlength="100">
					</div>
				</div>
				<div class="form-group">
					<label class="col-lg-3 col-md-3 col-sm-3 col-xs-3 control-label required">Usar muestreo:</label>
					<div class="col-lg-2 col-md-2 col-sm-3 col-xs-3" >
						<input type="checkbox" name="censo" class="switch" />
					</div>
					<label class="col-lg-2 col-md-2 col-sm-2 col-xs-2 control-label required">Consulta interna:</label>
					<div class="col-lg-2 col-md-2 col-sm-3 col-xs-3" >
						<input type="checkbox" name="interna" class="switch" checked />
					</div>
				</div>
				<div class="container-fluid">
					<button class="btn btn-primary pull-right m-r m-t" id="Go" type="submit" /><i class="fa fa-save"></i> Grabar proyecto</button>
				</div>
			</div>
		</form>
		</div>
	</div>
</div>
</div>
{%endblock%}
{%block scripts%}
<script src="{% static 'js/plugins/chosen/chosen.min.js' %}"></script>
<script>var config = {'.chosen-select': {},'.chosen-select-deselect'  : {allow_single_deselect:true},'.chosen-select-no-single' : {disable_search_threshold:10},'.chosen-select-no-results': {no_results_text:'No se encontraron resultados.'},'.chosen-select-width': {width:"95%"}};for (var selector in config) {$(selector).chosen(config[selector]);};</script>
<script type="text/javascript" src="{% static 'js/plugins/switchery/switchery.min.js' %}"></script>
<script>var elems = $('.switch'), lenelems = elems.length;for (var i = 0; i < lenelems; i++) {var switchery = new Switchery(elems[i]);}</script>
<script src="{% static 'js/plugins/summernote/summernote.min.js' %}"></script>
{% if 0%}
<script>
$(document).ready(function(){
	$('.summernote').summernote({height: 150,
	minHeight: null,
	maxHeight: null, });
	$('div .note-insert.btn-group').hide();
	$('div .note-view.btn-group').hide();
	$('div .note-help.btn-group').hide();
	$('div .note-table.btn-group').hide();
	$('div .note-height.btn-group').hide();
	$("#Dm").hide();
	$("#Ppe").hide();
});
var edit = function() {
	$('.click3edit').summernote({focus: true});
};
$( "form" ).submit(function( event ) {
	$('input[name="int_encuesta"]').attr('value',$('#summernote1').code());
	$('input[name="cue_correo"]').attr('value',$('#summernote3').code());
	return true;
});
$("#logo").change(function() {
    var val = $(this).val();
    switch(val.substring(val.lastIndexOf('.') + 1).toLowerCase()){
        case 'jpg': case 'png':
            $("#Go").show();
            break;
        default:
            $(this).val('');
            alert("Por favor seleccione una imagen");
            $("#Go").hide();
    }
});
$("#logoenc").change(function() {
    var val = $(this).val();
    switch(val.substring(val.lastIndexOf('.') + 1).toLowerCase()){
        case 'jpg': case 'png':
            $("#Go").show();
            break;
        default:
            $(this).val('');
            alert("Por favor seleccione una imagen");
            $("#Go").hide();
    }
});
var nombres =[],$nombre = $("#nombre"),$error=$('#error');
{% for i in Proyectos%}nombres.push('{{i.nombre |escape|safe}}');{%endfor%}
nnombres=nombres.length;
$nombre.keyup(function(){
	ban = false;
	for (var i = 0; i < nnombres; i++) {
		if($nombre.val() == nombres[i]){
			$error.html('<p id="error" style="color:red">Este nombre ya existe. Favor de elegir otro.</p>');
			ban = true;
		}
		if(! ban){$error.html('');}
	}
	$nombre.val
});
</script>{%endif%}
<script>$(document).ready(function(){$(".summernote").summernote({height:150,minHeight:null,maxHeight:null}),$("div .note-insert.btn-group").hide(),$("div .note-view.btn-group").hide(),$("div .note-help.btn-group").hide(),$("div .note-table.btn-group").hide(),$("div .note-height.btn-group").hide(),$("#Dm").hide(),$("#Ppe").hide()});var edit=function(){$(".click3edit").summernote({focus:!0})};$("form").submit(function(){return $('input[name="int_encuesta"]').attr("value",$("#summernote1").code()),$('input[name="cue_correo"]').attr("value",$("#summernote3").code()),!0}),$("#logo").change(function(){var e=$(this).val();switch(e.substring(e.lastIndexOf(".")+1).toLowerCase()){case"jpg":case"png":$("#Go").show();break;default:$(this).val(""),alert("Por favor seleccione una imagen"),$("#Go").hide()}}),$("#logoenc").change(function(){var e=$(this).val();switch(e.substring(e.lastIndexOf(".")+1).toLowerCase()){case"jpg":case"png":$("#Go").show();break;default:$(this).val(""),alert("Por favor seleccione una imagen"),$("#Go").hide()}});var nombres=[],$nombre=$("#nombre"),$error=$("#error");{% for i in Proyectos%}nombres.push('{{i.nombre |escape|safe}}');{%endfor%}nnombres=nombres.length,$nombre.keyup(function(){ban=!1;for(var e=0;nnombres>e;e++)$nombre.val()==nombres[e]&&($error.html('<p id="error" style="color:red">Este nombre ya existe. Favor elegir otro.</p>'),ban=!0),ban||$error.html("");$nombre.val});</script>
{% endblock %}
