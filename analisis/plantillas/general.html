{% extends "dash2.html" %}{%load staticfiles %}
{% block title %} A. General{% endblock %}
{% block head2 %}
<link rel="stylesheet" href=" {% static 'plugins/jQRangeSlider-master/css/iThing.css' %}  " type="text/css" />
<style media="screen">.multiselect{margin-left: -15px !important;}.panel-body{opacity:0}#control_grafica_dos_div div div span,#control_grafica_tres_div div div span,#control_grafica_uno_div div div span,#grafica_dos_div div div span,#grafica_tres_div div div span,#grafica_uno_div div div span{display:none!important}</style>
{% endblock %}
{% block navegacion%}
<li><a href="/home/"><i class="fa fa-home"></i></a></li>
<li><a href="#"><i><span>/ Análisis</span></i></a></li>
<li><a href="#"><i><span>/ General</span></i></a></li>
{%endblock%}
{% block contenido2 %}
<div class="row">
	<div class="panel panel-default toggle m-t-xs ml20 mr20">
		<div class="panel-heading">
			<h4 class="panel-title">Promedio general en tiempo real</h4>
		</div>
		<div class="panel-body">
			<div class="col-lg-9">
				<div align="center">
					<input id="lastDay" type="button" value="Ultimo Dia" />
					<input id="lastWeek" type="button" value="Ultima Semana" />
					<input id="lastMonth" type="button" value="Ultimo Mes" />
				</div>
				<div style='margin: 0 5px 0 5px' id="grafica_uno_div"></div>
				<div style='margin: 0 5px 0 5px' id="control_grafica_uno_div"></div>
			</div>

			<div class="col-lg-3 m-t-xs">
				<div class="panel panel-default toggle">
					<!-- Inicio .panel -->
					<div class="panel-heading">
						<h4 class="panel-title"><i class="glyphicon glyphicon-list-alt"></i> Filtros </h4>
					</div>
					<div class="panel-body">
						<ul class="list-unstyled mb0">
							<li class="mb5 pb5 bbdashed">
								<span class="strong pr25" >Variables</span>
								<select id="variables_g1" class="filtro filtros_uno" multiple></select>
							</li>
							<li class="mb5 pb5 bbdashed">
								<span class="strong pr15">Regionales</span>
								<select id="regionales_g1" class="filtro filtros_uno" multiple></select>
							</li>
							<li class="mb5 pb5 bbdashed">
								<span class="strong pr25">Ciudades</span>
								<select id="ciudades_g1" class="filtro filtros_uno" multiple></select>
							</li>
							<li class="mb5 pb5 bbdashed">
								<span class="strong" style="padding-right:47px">Áreas</span>
								<select id="areas_g1" class="filtro filtros_uno" multiple></select>
							</li>
							<li class="mb5 pb5 bbdashed">
								<span class="strong" style="padding-right:39px">Cargos</span>
								<select id="cargos_g1" class="filtro filtros_uno" multiple></select>
							</li>
							{%if Datos.0.proyecto.proyectosdatos.opcional1 %}
							<li class="mb5 pb5 bbdashed">
								<span class="strong pr15">{{ Datos.0.proyecto.proyectosdatos.opcional1 | escape }}</span>
								<select id="opcional1_g1" class="filtro filtros_uno" multiple></select>
							</li>
							{% endif %}
							{%if Datos.0.proyecto.proyectosdatos.opcional2 %}
							<li class="mb5 pb5 bbdashed">
								<span class="strong pr15">{{ Datos.0.proyecto.proyectosdatos.opcional2 | escape }}</span>
								<select id="opcional2_g1" class="filtro filtros_uno" multiple></select>
							</li>
							{% endif %}
							{%if Datos.0.proyecto.proyectosdatos.opcional3 %}
							<li class="mb5 pb5 bbdashed">
								<span class="strong pr15">{{ Datos.0.proyecto.proyectosdatos.opcional3 | escape }}</span>
								<select id="opcional3_g1" class="filtro filtros_uno" multiple></select>
							</li>
							{% endif %}
							{%if Datos.0.proyecto.proyectosdatos.opcional4 %}
							<li class="mb5 pb5 bbdashed">
								<span class="strong pr15">{{ Datos.0.proyecto.proyectosdatos.opcional4 | escape }}</span>
								<select id="opcional4_g1" class="filtro filtros_uno" multiple></select>
							</li>
							{% endif %}
							{%if Datos.0.proyecto.proyectosdatos.opcional5 %}
							<li class="mb5 pb5 bbdashed">
								<span class="strong pr15">{{ Datos.0.proyecto.proyectosdatos.opcional5 | escape }}</span>
								<select id="opcional5_g1" class="filtro filtros_uno" multiple></select>
							</li>
							{% endif %}
						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="panel panel-default toggle m-t-xs ml20 mr20">
		<div class="panel-heading">
			<h4 class="panel-title">Resultados Generales Promedio Por Variable</h4>
		</div>
		<div class="panel-body">
			<div class="col-lg-9">
				<div style='margin: 0 5px 0 5px' id="grafica_dos_div"></div>
				<br>
				<div id="control_grafica_dos_div"></div>
			</div>

			<div class="col-lg-3">
				<div class="panel panel-default toggle">

					<div class="panel-heading">
						<h4 class="panel-title"><i class="glyphicon glyphicon-list-alt"></i> Filtros</h4>
					</div>
					<div class="panel-body">
						<ul class="list-unstyled mb0">
							<li class="mb5 pb5 bbdashed">
								<span class="strong pr25" >Variables</span>
								<select id="variables_g2" class="filtro filtros_dos" multiple></select>
							</li>
							<li class="mb5 pb5 bbdashed">
								<span class="strong pr15">Regionales</span>
								<select id="regionales_g2" class="filtro filtros_dos" multiple></select>
							</li>
							<li class="mb5 pb5 bbdashed">
								<span class="strong pr25">Ciudades</span>
								<select id="ciudades_g2" class="filtro filtros_dos" multiple></select>
							</li>
							<li class="mb5 pb5 bbdashed">
								<span class="strong" style="padding-right:47px">Áreas</span>
								<select id="areas_g2" class="filtro filtros_dos" multiple></select>
							</li>
							<li class="mb5 pb5 bbdashed">
								<span class="strong" style="padding-right:39px">Cargos</span>
								<select id="cargos_g2" class="filtro filtros_dos" multiple></select>
							</li>
							{%if Datos.0.proyecto.proyectosdatos.opcional1 %}
							<li class="mb5 pb5 bbdashed">
								<span class="strong pr15">{{ Datos.0.proyecto.proyectosdatos.opcional1 | escape }}</span>
								<select id="opcional1_g2" class="filtro filtros_dos" multiple></select>
							</li>
							{% endif %}
							{%if Datos.0.proyecto.proyectosdatos.opcional2 %}
							<li class="mb5 pb5 bbdashed">
								<span class="strong pr15">{{ Datos.0.proyecto.proyectosdatos.opcional2 | escape }}</span>
								<select id="opcional2_g2" class="filtro filtros_dos" multiple></select>
							</li>
							{% endif %}
							{%if Datos.0.proyecto.proyectosdatos.opcional3 %}
							<li class="mb5 pb5 bbdashed">
								<span class="strong pr15">{{ Datos.0.proyecto.proyectosdatos.opcional3 | escape }}</span>
								<select id="opcional3_g2" class="filtro filtros_dos" multiple></select>
							</li>
							{% endif %}
							{%if Datos.0.proyecto.proyectosdatos.opcional4 %}
							<li class="mb5 pb5 bbdashed">
								<span class="strong pr15">{{ Datos.0.proyecto.proyectosdatos.opcional4 | escape }}</span>
								<select id="opcional4_g2" class="filtro filtros_dos" multiple></select>
							</li>
							{% endif %}
							{%if Datos.0.proyecto.proyectosdatos.opcional5 %}
							<li class="mb5 pb5 bbdashed">
								<span class="strong pr15">{{ Datos.0.proyecto.proyectosdatos.opcional5 | escape }}</span>
								<select id="opcional5_g2" class="filtro filtros_dos" multiple></select>
							</li>
							{% endif %}
						</ul>

					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="panel panel-default toggle m-t-xs ml20 mr20">
		<div class="panel-heading">
			<h4 class="panel-title">Resultados Generales Promedio Por Variable</h4>
		</div>
		<div class="panel-body">
			<div class="col-lg-9">
				<div style='margin: 0 5px 0 5px' id="grafica_tres_div"></div>
				<div style='margin: 0 5px 0 5px' id="control_grafica_tres_div"></div>
			</div>

			<div class="col-lg-3">
				<div class="panel panel-default toggle">
					<div class="panel-heading">
						<h4 class="panel-title"><i class="glyphicon glyphicon-list-alt"></i> Filtros</h4>
					</div>
					<div class="panel-body">
						<ul class="list-unstyled mb0">
							<li class="mb5 pb5 bbdashed">
								<span class="strong pr25" >Variables</span>
								<select id="variables_g3" class="filtros_tres" ></select>
							</li>
							<li class="mb5 pb5 bbdashed">
								<span class="strong pr20" >Preguntas</span>
								<select id="preguntas_g3" class="filtro filtros_tres" multiple></select>
							</li>
							<li class="mb5 pb5 bbdashed">
								<span class="strong pr15">Regionales</span>
								<select id="regionales_g3" class="filtro filtros_tres" multiple></select>
							</li>
							<li class="mb5 pb5 bbdashed">
								<span class="strong pr25">Ciudades</span>
								<select id="ciudades_g3" class="filtro filtros_tres" multiple></select>
							</li>
							<li class="mb5 pb5 bbdashed">
								<span class="strong" style="padding-right:47px">Áreas</span>
								<select id="areas_g3" class="filtro filtros_tres" multiple></select>
							</li>
							<li class="mb5 pb5 bbdashed">
								<span class="strong" style="padding-right:39px">Cargos</span>
								<select id="cargos_g3" class="filtro filtros_tres" multiple></select>
							</li>
							{%if Datos.0.proyecto.proyectosdatos.opcional1 %}
							<li class="mb5 pb5 bbdashed">
								<span class="strong pr15">{{ Datos.0.proyecto.proyectosdatos.opcional1 | escape }}</span>
								<select id="opcional1_g3" class="filtro filtros_tres" multiple></select>
							</li>
							{% endif %}
							{%if Datos.0.proyecto.proyectosdatos.opcional2 %}
							<li class="mb5 pb5 bbdashed">
								<span class="strong pr15">{{ Datos.0.proyecto.proyectosdatos.opcional2 | escape }}</span>
								<select id="opcional2_g3" class="filtro filtros_tres" multiple></select>
							</li>
							{% endif %}
							{%if Datos.0.proyecto.proyectosdatos.opcional3 %}
							<li class="mb5 pb5 bbdashed">
								<span class="strong pr15">{{ Datos.0.proyecto.proyectosdatos.opcional3 | escape }}</span>
								<select id="opcional3_g3" class="filtro filtros_tres" multiple></select>
							</li>
							{% endif %}
							{%if Datos.0.proyecto.proyectosdatos.opcional4 %}
							<li class="mb5 pb5 bbdashed">
								<span class="strong pr15">{{ Datos.0.proyecto.proyectosdatos.opcional4 | escape }}</span>
								<select id="opcional4_g3" class="filtro filtros_tres" multiple></select>
							</li>
							{% endif %}
							{%if Datos.0.proyecto.proyectosdatos.opcional5 %}
							<li class="mb5 pb5 bbdashed">
								<span class="strong pr15">{{ Datos.0.proyecto.proyectosdatos.opcional5 | escape }}</span>
								<select id="opcional5_g3" class="filtro filtros_tres" multiple></select>
							</li>
							{% endif %}
						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
{% endblock %}

{%block scripts%}
<script type="text/javascript" src="https://www.google.com/jsapi?autoload={'modules':[{'name':'visualization','version':'1.1','packages':['corechart']}]}"></script>
<script type="text/javascript" src="{% static 'js/plugins/multiselect/bootstrap-multiselect.min.js' %}"></script>

<script type="text/javascript" src="{% static 'plugins/jQRangeSlider-master/jQRangeSliderMouseTouch.min.js'%} "></script>
<script type="text/javascript" src="{% static 'plugins/jQRangeSlider-master/jQRangeSliderDraggable.min.js'%} "></script>
<script type="text/javascript" src="{% static 'plugins/jQRangeSlider-master/jQRangeSliderBar.min.js'%}"></script>
<script type="text/javascript" src="{% static 'plugins/jQRangeSlider-master/jQRangeSliderHandle.min.js'%}"></script>
<script type="text/javascript" src="{% static 'plugins/jQRangeSlider-master/jQDateRangeSliderHandle.min.js'%}"></script>
<script type="text/javascript" src="{% static 'plugins/jQRangeSlider-master/jQRangeSliderLabel.min.js'%}"></script>
<script type="text/javascript" src="{% static 'plugins/jQRangeSlider-master/jQRangeSlider.min.js'%}"></script>
<script type="text/javascript" src="{% static 'plugins/jQRangeSlider-master/jQDateRangeSlider.min.js'%}"></script>
<script type="text/javascript" src="https://www.google.com/jsapi?autoload={'modules':[{'name':'visualization','version':'1.1','packages':['corechart']}]}"></script>
<script type="text/javascript" src="{% static 'js/plugins/multiselect/bootstrap-multiselect.min.js' %}"></script>

<script type="text/javascript">
// $('.filtro').multiselect({numberDisplayed: 1,includeSelectAllOption: true,buttonWidth: '130px',dropRight: true,disableIfEmpty: true	});
var Datos = [{%for i in Datos%}['{{ i.colaborador.nombre | escape}}'+'{{ i.colaborador.apellido  | escape }}' , '{{ i.pregunta.variable.nombre | escape }}' , '{{ i.pregunta.texto | escape }}' , '{{ i.colaborador.colaboradoresdatos.regional | lower | escape}}' , '{{ i.colaborador.colaboradoresdatos.ciudad | lower | escape}}' , '{{ i.colaborador.colaboradoresdatos.area | lower | escape }}' , '{{ i.colaborador.colaboradoresdatos.cargo | lower | escape }}' , {%if i.pregunta.multiple%}{%ifequal i.respuesta "0"%}['0'],{%else%}{{ i.respuesta | safe | escape }},{%endifequal%}{%endif%} {%if i.pregunta.abierta or i.pregunta.multiple%}{%else%}{%ifequal i.respuesta "0"%}['0'],{%else%}['{{ i.respuesta | escape}}'],{%endifequal%}{%endif%} new Date({{ i.fecharespuesta.year }},{{ i.fecharespuesta.month | add:-1 }},{{ i.fecharespuesta.day }}), '{{ i.colaborador.colaboradoresdatos.opcional1 | escape }}','{{ i.colaborador.colaboradoresdatos.opcional2 | escape }}','{{ i.colaborador.colaboradoresdatos.opcional3 | escape }}','{{ i.colaborador.colaboradoresdatos.opcional4 | escape }}','{{ i.colaborador.colaboradoresdatos.opcional5 | escape }}',{{ i.pregunta.variable.id }},{{ i.pregunta.id }}, "{{ i.pregunta.numerica }}" ],{%endfor%}];
var Cuestionario = [ {% for i in Preguntas %}['{{ i.variable.id | escape }}',{ '{{ i.id | escape }}':{ {% for j in i.respuestas_set.all %} '{{ j.texto | escape}}': {% if j.numerico %}{{ j.numerico | escape }}{% else %}0{% endif %},{% endfor %} } } ],{% endfor %}];

var contenido = function(a,x){
	for (var i = 0; i < x.length; i++) if (a == x[i]) return true;
	return false;
}
var contenido_date = function(a,x){
	for (var i = 0; i < x.length; i++) if (a - x[i] == 0) return true;
	return false;
}
var limpiar_filas_nulas = function(matriz_datos){
	var long_fila = matriz_datos[0].length;
	for( var i = 1; i < matriz_datos.length; i++ ) {
		for (var j = 1; j < long_fila; j++)
			if (matriz_datos[i][j] == 0 )
				matriz_datos[i][j] = matriz_datos[i-1][j];
	}
	return matriz_datos;
}

var maximo_cuestionario = 5;
for (var i = 0; i < Cuestionario.length; i++) {
	for (var key in Cuestionario[i][1]) {
		if (Cuestionario[i][1].hasOwnProperty(key)){
			for (var key2 in Cuestionario[i][1][key]) {
				if (Cuestionario[i][1][key].hasOwnProperty(key2) && Cuestionario[i][1][key][key2] > maximo_cuestionario)
			 		maximo_cuestionario = Cuestionario[i][1][key][key2];
			 }
		}
	}
}
var calculePuntaje = function calculePuntaje(idVariable,idPregunta,respuesta){
	    var total = 0;
		for(k=0;k<Cuestionario.length;k++){
			if(idVariable == Cuestionario[k][0] && Cuestionario[k][1].hasOwnProperty(idPregunta)){
				for(m in Cuestionario[k][1][idPregunta]){
					if(contenido(m,respuesta)){
						total  += Cuestionario[k][1][idPregunta][m]
					}
				}
			}
		}
	  return total
}

var tiemposIniciales = function(fechas){
	var tiempoMaximo = new Date(2000,1,20).getTime(),
		tiempoMinimo = new Date(2030,1,20).getTime(),
		fechaMaxima = new Date(2030,1,20),
		fechaMinima = new Date(2000,1,20);
	for(var i=0;i<fechas.length;i++){
			var tiempo = fechas[i].getTime(),
				fecha = fechas[i];
			if(tiempo>tiempoMaximo){
				tiempoMaximo = tiempo;
                fechaMaxima = fecha;
				}
			if(tiempo<tiempoMinimo){
				tiempoMinimo = tiempo;
				fechaMinima = fecha;
			}
		}
    return [tiempoMinimo,tiempoMaximo,fechaMinima,fechaMaxima];
}

//==============================================================================
//   variables GLOBALES
//==============================================================================

var regionales=[],ciudades=[],areas=[],cargos=[], 	fechas=[], variables = [], preguntas = [],
	$var_g1=$('#variables_g1'), $reg_g1 = $('#regionales_g1'), $ciu_g1 = $('#ciudades_g1'),
	$are_g1 = $('#areas_g1'), $car_g1 = $('#cargos_g1');

{%if Datos.0.proyecto.proyectosdatos.opcional1 %}var $op1_g1 = $('#opcional1_g1'),opcional1=[];{% endif %}
{%if Datos.0.proyecto.proyectosdatos.opcional2 %}var $op2_g1 = $('#opcional2_g1'),opcional2=[];{% endif %}
{%if Datos.0.proyecto.proyectosdatos.opcional3 %}var $op3_g1 = $('#opcional3_g1'),opcional3=[];{% endif %}
{%if Datos.0.proyecto.proyectosdatos.opcional4 %}var $op4_g1 = $('#opcional4_g1'),opcional4=[];{% endif %}
{%if Datos.0.proyecto.proyectosdatos.opcional5 %}var $op5_g1 = $('#opcional5_g1'),opcional5=[];{% endif %}

var $reg_g2 = $('#regionales_g2'), $ciu_g2 = $('#ciudades_g2'), $var_g2 = $('#variables_g2'),
	$are_g2 = $('#areas_g2'), $car_g2 = $('#cargos_g2');

{%if Datos.0.proyecto.proyectosdatos.opcional1 %}var $op1_g2 = $('#opcional1_g2');{% endif %}
{%if Datos.0.proyecto.proyectosdatos.opcional2 %}var $op2_g2 = $('#opcional2_g2');{% endif %}
{%if Datos.0.proyecto.proyectosdatos.opcional3 %}var $op3_g2 = $('#opcional3_g2');{% endif %}
{%if Datos.0.proyecto.proyectosdatos.opcional4 %}var $op4_g2 = $('#opcional4_g2');{% endif %}
{%if Datos.0.proyecto.proyectosdatos.opcional5 %}var $op5_g2 = $('#opcional5_g2');{% endif %}


var $reg_g3 = $('#regionales_g3'), $ciu_g3 = $('#ciudades_g3'),
	$are_g3 = $('#areas_g3'), $car_g3 = $('#cargos_g3')
	$var_g3 = $('#variables_g3'), $pre_g3 = $('#preguntas_g3');

{%if Datos.0.proyecto.proyectosdatos.opcional1 %}var $op1_g3 = $('#opcional1_g3');{% endif %}
{%if Datos.0.proyecto.proyectosdatos.opcional2 %}var $op2_g3 = $('#opcional2_g3');{% endif %}
{%if Datos.0.proyecto.proyectosdatos.opcional3 %}var $op3_g3 = $('#opcional3_g3');{% endif %}
{%if Datos.0.proyecto.proyectosdatos.opcional4 %}var $op4_g3 = $('#opcional4_g3');{% endif %}
{%if Datos.0.proyecto.proyectosdatos.opcional5 %}var $op5_g3 = $('#opcional5_g3');{% endif %}


var Elementos = {
	//==============================================================================
	//   Selects
	//==============================================================================
	inicio : function(){

		for (var i = 0; i < Datos.length; i++) {

			if(!contenido_date(Datos[i][8],fechas)){
				fechas.push(Datos[i][8]);
			}

			if (!contenido(Datos[i][14],variables)){
				variables.push(Datos[i][14]);

				$var_g1.append($('<option>',{
					value: Datos[i][14],
					text: Datos[i][1],
				}))

			  if(Datos[i][16] == "True"){
					$var_g2.append($('<option>',{
						value: Datos[i][14],
						text: Datos[i][1],
					        }))
					}

			if(Datos[i][16] == "True"){
				$var_g3.append($('<option>',{
					value: Datos[i][14],
					text: Datos[i][1],
				           }))
				}

			}

			if (!contenido(Datos[i][15],preguntas) ){
				if ( Datos[i][14] == variables[0] ){
					$pre_g3.append($('<option>', {
						value: Datos[i][15],
						text : Datos[i][2]
					}));
				}
				preguntas.push(Datos[i][15]);
			}

			if (!contenido(Datos[i][3],regionales)){
				regionales.push(Datos[i][3]);
				$reg_g1.append($('<option>', {
					value: Datos[i][3],
					text : Datos[i][3]
				}));
				$reg_g2.append($('<option>', {
					value: Datos[i][3],
					text : Datos[i][3]
				}));
				$reg_g3.append($('<option>', {
					value: Datos[i][3],
					text : Datos[i][3]
				}));
			}
			if (!contenido(Datos[i][4],ciudades)){
				ciudades.push(Datos[i][4]);
				$ciu_g1.append($('<option>', {
					value: Datos[i][4],
					text : Datos[i][4]
				}));
				$ciu_g2.append($('<option>', {
					value: Datos[i][4],
					text : Datos[i][4]
				}));
				$ciu_g3.append($('<option>', {
					value: Datos[i][4],
					text : Datos[i][4]
				}));


			}
			if (!contenido(Datos[i][5],areas)){
				areas.push(Datos[i][5]);
				$are_g1.append($('<option>', {
					value: Datos[i][5],
					text : Datos[i][5]
				}));
				$are_g2.append($('<option>', {
					value: Datos[i][5],
					text : Datos[i][5]
				}));
				$are_g3.append($('<option>', {
					value: Datos[i][5],
					text : Datos[i][5]
				}));
			}
			if (!contenido(Datos[i][6],cargos)){
				cargos.push(Datos[i][6]);
				$car_g1.append($('<option>', {
					value: Datos[i][6],
					text : Datos[i][6]
				}));
				$car_g2.append($('<option>', {
					value: Datos[i][6],
					text : Datos[i][6]
				}));
				$car_g3.append($('<option>', {
					value: Datos[i][6],
					text : Datos[i][6]
				}));
			}


			{%if Datos.0.proyecto.proyectosdatos.opcional1 %}
			if (!contenido(Datos[i][9],opcional1)){
				opcional1.push(Datos[i][9]);
				$op1_g1.append($('<option>', {
					value: Datos[i][9],
					text : Datos[i][9]
				}));
				$op1_g2.append($('<option>', {
					value: Datos[i][9],
					text : Datos[i][9]
				}));
				$op1_g3.append($('<option>', {
					value: Datos[i][9],
					text : Datos[i][9]
				}));
			}
			{% endif %}
			{%if Datos.0.proyecto.proyectosdatos.opcional2 %}
			if (!contenido(Datos[i][10],opcional2)){
				opcional2.push(Datos[i][10]);
				$op2_g1.append($('<option>', {
					value: Datos[i][10],
					text : Datos[i][10]
				}));
				$op2_g2.append($('<option>', {
					value: Datos[i][10],
					text : Datos[i][10]
				}));
				$op2_g3.append($('<option>', {
					value: Datos[i][10],
					text : Datos[i][10]
				}));
			}
			{% endif %}
			{%if Datos.0.proyecto.proyectosdatos.opcional3 %}
			if (!contenido(Datos[i][11],opcional3)){
				opcional3.push(Datos[i][11]);
				$op3_g1.append($('<option>', {
					value: Datos[i][11],
					text : Datos[i][11]
				}));
				$op3_g2.append($('<option>', {
					value: Datos[i][11],
					text : Datos[i][11]
				}));
				$op3_g3.append($('<option>', {
					value: Datos[i][11],
					text : Datos[i][11]
				}));
			}
			{% endif %}
			{%if Datos.0.proyecto.proyectosdatos.opcional4 %}
			if (!contenido(Datos[i][12],opcional4)){
				opcional4.push(Datos[i][12]);
				$op4_g1.append($('<option>', {
					value: Datos[i][12],
					text : Datos[i][12]
				}));
				$op4_g2.append($('<option>', {
					value: Datos[i][12],
					text : Datos[i][12]
				}));
				$op4_g3.append($('<option>', {
					value: Datos[i][12],
					text : Datos[i][12]
				}));
			}
			{% endif %}
			{%if Datos.0.proyecto.proyectosdatos.opcional5 %}
			if (!contenido(Datos[i][13],opcional5)){
				opcional5.push(Datos[i][13]);
				$op5_g1.append($('<option>', {
					value: Datos[i][13],
					text : Datos[i][13]
				}));
				$op5_g2.append($('<option>', {
					value: Datos[i][13],
					text : Datos[i][13]
				}));
				$op5_g3.append($('<option>', {
					value: Datos[i][13],
					text : Datos[i][13]
				}));
			}
			{% endif %}

		}

		$var_g3.change(function(){
			var preguntas3 = [];
			$pre_g3.find('option').remove();
			for (var i = 0; i < Datos.length; i++) {
				if ( !contenido(Datos[i][15],preguntas3) && Datos[i][14] == $var_g3.val() ){
					preguntas3.push(Datos[i][15]);
					$pre_g3.append($('<option>', {
						value: Datos[i][15],
						text : Datos[i][2]
					}));
				}
			}
			$pre_g3.multiselect('rebuild');
			$pre_g3.multiselect('selectAll', false);
			$pre_g3.multiselect('updateButtonText');
		});


		//  UPDATE Selects
		$('.filtro').multiselect({numberDisplayed: 1,includeSelectAllOption: true,buttonWidth: '130px',dropRight: true,disableIfEmpty: true	});
		$('.filtro').multiselect('selectAll', false);
		$('.filtro').multiselect('updateButtonText');
		// $var_g2.multiselect({numberDisplayed: 1,includeSelectAllOption: true,buttonWidth: '130px',dropRight: true,disableIfEmpty: true	});
		// $var_g2.selectedIndex = 0;
		// $var_g2.multiselect('updateButtonText');
		$var_g3.multiselect({numberDisplayed: 1,includeSelectAllOption: true,buttonWidth: '130px',dropRight: true,disableIfEmpty: true	});
		$var_g3.selectedIndex = 0;
		$var_g3.multiselect('updateButtonText');

	},

	//==============================================================================
	//   Grafica UNO
	//==============================================================================
	grafica_uno: function(){
		// cacheamos las seleccionadas
		var {%if Datos.0.proyecto.proyectosdatos.opcional1 %}opcional1_seleccionadas = $op1_g1.val() || [],{% endif %}
			{%if Datos.0.proyecto.proyectosdatos.opcional2 %}opcional2_seleccionadas = $op2_g1.val() || [],{% endif %}
			{%if Datos.0.proyecto.proyectosdatos.opcional3 %}opcional3_seleccionadas = $op3_g1.val() || [],{% endif %}
			{%if Datos.0.proyecto.proyectosdatos.opcional4 %}opcional4_seleccionadas = $op4_g1.val() || [],{% endif %}
			{%if Datos.0.proyecto.proyectosdatos.opcional5 %}opcional5_seleccionadas = $op5_g1.val() || [],{% endif %}
			variables_seleccionadas = $var_g1.val() || [],
			regionales_seleccionadas = $reg_g1.val() || [],
			ciudades_seleccionadas = $ciu_g1.val() || [],
			areas_seleccionadas = $are_g1.val() || [],
			cargos_seleccionados = $car_g1.val() || [];

		// inicializamos las variables de la data table
		var data = new google.visualization.DataTable();
		data.addColumn('date', 'Fecha');
		data.addColumn('number', 'Promedio Medición');
		var matriz_g1 = [],auxiliar=0;

		// inicializamos la date tables
		for (var i = 0; i < fechas.length; i++)
			matriz_g1.push([ fechas[i],0.0 ]);

		// contamos
		for (var i = 0; i < matriz_g1.length; i++) {
			for (var j = 0; j < Datos.length; j++) {
				if( contenido( Datos[j][14], variables_seleccionadas )
				&& matriz_g1[i][0].getTime() === Datos[j][8].getTime()
				&& Datos[j][16] == "True"
				&& contenido(Datos[j][3],regionales_seleccionadas)
				&& contenido(Datos[j][4],ciudades_seleccionadas)
				&& contenido(Datos[j][5],areas_seleccionadas)
				&& contenido(Datos[j][6],cargos_seleccionados)
				{%if Datos.0.proyecto.proyectosdatos.opcional1 %}
					&& contenido(Datos[j][9],opcional1_seleccionadas)
				{% endif %}
				{%if Datos.0.proyecto.proyectosdatos.opcional2 %}
					&& contenido(Datos[j][10],opcional2_seleccionadas)
				{% endif %}
				{%if Datos.0.proyecto.proyectosdatos.opcional3 %}
					&& contenido(Datos[j][11],opcional3_seleccionadas)
				{% endif %}
				{%if Datos.0.proyecto.proyectosdatos.opcional4 %}
					&& contenido(Datos[j][12],opcional4_seleccionadas)
				{% endif %}
				{%if Datos.0.proyecto.proyectosdatos.opcional5 %}
					&& contenido(Datos[j][13],opcional5_seleccionadas)
				{% endif %}
			){
					for (var l = 0; l < Cuestionario.length; l++) {
						for (var m = 0; m < Datos[j][7].length; m++) {
							if( Cuestionario[l][1][Datos[j][15]] && Cuestionario[l][1][Datos[j][15]][ Datos[j][7][m] ] ){
								matriz_g1[i][1] += Cuestionario[l][1][Datos[j][15]][ Datos[j][7][m] ];
								auxiliar++;
							}
						}
					}
				}
			}

			if(auxiliar){
				matriz_g1[i][1] = +(Math.round(matriz_g1[i][1]/auxiliar+ "e+2")  + "e-2");
				auxiliar = 0;
			}

		}

		matriz_g1 = limpiar_filas_nulas(matriz_g1);

		data.addRows( matriz_g1 );

		var altura = 200;
		{%if Datos.0.proyecto.proyectosdatos.opcional1 %}altura+=40;{% endif %}
		{%if Datos.0.proyecto.proyectosdatos.opcional2 %}altura+=40;{% endif %}
		{%if Datos.0.proyecto.proyectosdatos.opcional3 %}altura+=40;{% endif %}
		{%if Datos.0.proyecto.proyectosdatos.opcional4 %}altura+=40;{% endif %}
		{%if Datos.0.proyecto.proyectosdatos.opcional5 %}altura+=40;{% endif %}

		var chart = new google.visualization.ChartWrapper({
			chartType: 'LineChart',
			containerId: 'grafica_uno_div',
			options: {
				height: altura,
				legend: 'none',
				colors: ['#43AEA8'],
				chartArea: {
					width: '90%'
				},
				vAxis : {
				   maxValue: maximo_cuestionario,
				   minValue: 0
			   },
			}
		});

		var control = new google.visualization.ControlWrapper({
			controlType: 'ChartRangeFilter',
			containerId: 'control_grafica_uno_div',
			options: {
				filterColumnIndex: 0,
				ui: {
					chartOptions: {
						height: 50,
						colors: ['#43AEA8'],
						chartArea: {
							width: '90%'
						}
					}
				}
			}
		});

		var dashboard = new google.visualization.Dashboard(document.querySelector('#dashboard_div'));
		dashboard.bind([control], [chart]);
		dashboard.draw(data);

		function zoomLastDay () {
			var range = data.getColumnRange(0);
			control.setState({
				range: {
					start: new Date(range.max.getFullYear(), range.max.getMonth(), range.max.getDate() - 1),
					end: range.max
				}
			});
			control.draw();
		}
		function zoomLastWeek () {
			var range = data.getColumnRange(0);
			control.setState({
				range: {
					start: new Date(range.max.getFullYear(), range.max.getMonth(), range.max.getDate() - 7),
					end: range.max
				}
			});
			control.draw();
		}
		function zoomLastMonth () {
			// zoom here sets the month back 1, which can have odd effects when the last month has more days than the previous month
			// eg: if the last day is March 31, then zooming last month will give a range of March 3 - March 31, as this sets the start date to February 31, which doesn't exist
			// you can tweak this to make it function differently if you want
			var range = data.getColumnRange(0);
			control.setState({
				range: {
					start: new Date(range.max.getFullYear(), range.max.getMonth() - 1, range.max.getDate()),
					end: range.max
				}
			});
			control.draw();
		}

		var runOnce = google.visualization.events.addListener(dashboard, 'ready', function () {
			google.visualization.events.removeListener(runOnce);

			if (document.addEventListener) {
				document.querySelector('#lastDay').addEventListener('click', zoomLastDay);
				document.querySelector('#lastWeek').addEventListener('click', zoomLastWeek);
				document.querySelector('#lastMonth').addEventListener('click', zoomLastMonth);
			}
			else if (document.attachEvent) {
				document.querySelector('#lastDay').attachEvent('onclick', zoomLastDay);
				document.querySelector('#lastWeek').attachEvent('onclick', zoomLastWeek);
				document.querySelector('#lastMonth').attachEvent('onclick', zoomLastMonth);
			}
			else {
				document.querySelector('#lastDay').onclick = zoomLastDay;
				document.querySelector('#lastWeek').onclick = zoomLastWeek;
				document.querySelector('#lastMonth').onclick = zoomLastMonth;
			}
		});
	},

	//==============================================================================
	//   Grafica DOS
	//==============================================================================
grafica_dos: function(dataTable){
    var data2 = new google.visualization.DataTable();
	data2.addColumn('string','Variable');
    data2.addColumn('number','Promedio Total');
	data2.addColumn('number','Promedio Filtro');
<<<<<<< HEAD

	data2.addRows(dataTable);
	var altura = 260;
	{%if Datos.0.proyecto.proyectosdatos.opcional1 %}altura+=40;{% endif %}
	{%if Datos.0.proyecto.proyectosdatos.opcional2 %}altura+=40;{% endif %}
	{%if Datos.0.proyecto.proyectosdatos.opcional3 %}altura+=40;{% endif %}
	{%if Datos.0.proyecto.proyectosdatos.opcional4 %}altura+=40;{% endif %}
	{%if Datos.0.proyecto.proyectosdatos.opcional5 %}altura+=40;{% endif %}

	var options = {   height: altura,
					  legend: {position: 'top', maxLines: 1,'alignment':'center'},
	};
	var chart = new google.visualization.ColumnChart(document.getElementById('grafica_dos_div'));
	chart.draw(data2, options);


},
dataTab2: function(fechaInicial,fechaFinal){
	var {%if Datos.0.proyecto.proyectosdatos.opcional1 %}opcional1_seleccionadas = $op1_g3.val() || [],{% endif %}
		{%if Datos.0.proyecto.proyectosdatos.opcional2 %}opcional2_seleccionadas = $op2_g3.val() || [],{% endif %}
		{%if Datos.0.proyecto.proyectosdatos.opcional3 %}opcional3_seleccionadas = $op3_g3.val() || [],{% endif %}
		{%if Datos.0.proyecto.proyectosdatos.opcional4 %}opcional4_seleccionadas = $op4_g3.val() || [],{% endif %}
		{%if Datos.0.proyecto.proyectosdatos.opcional5 %}opcional5_seleccionadas = $op5_g3.val() || [],{% endif %}
		variables_seleccionadas = $var_g2.val() || [],
		regionales_seleccionadas = $reg_g2.val() || [],
		ciudades_seleccionadas = $ciu_g2.val() || [],
		areas_seleccionadas = $are_g2.val() || [],
 		cargos_seleccionados = $car_g2.val() || [];

		var matrizTotal= [], variables = [];
		var puntajeVariables = [], indiceVariables = [];
        var totalPersonas = Datos.length;
		for(z=0;z<totalPersonas;z++){
			if(Datos[z][16]=='True'){
		                var puntajePendejo = calculePuntaje(Datos[z][14],Datos[z][15],Datos[z][7]);
						if(!contenido(Datos[z][14],indiceVariables)){
							puntajeVariables.push(puntajePendejo/totalPersonas);
							indiceVariables.push(Datos[z][14]);
						  }else{
								var ind1 = indiceVariables.indexOf(Datos[z][14]);
								puntajeVariables[ind1] += puntajePendejo/totalPersonas;
							}
			}
		}

        var totalPersonasFiltro = 0;

		for(r=0;r<totalPersonas;r++){
            if(
				fechaInicial<=Datos[r][8].getTime()
				&&Datos[r][8].getTime()<=fechaFinal
				&& contenido(Datos[r][14],variables_seleccionadas)
				&& Datos[r][16] == "True"
				&& contenido(Datos[r][3],regionales_seleccionadas)
				&& contenido(Datos[r][4],ciudades_seleccionadas)
				&& contenido(Datos[r][5],areas_seleccionadas)
				&& contenido(Datos[r][6],cargos_seleccionados)
				{%if Datos.0.proyecto.proyectosdatos.opcional1 %}
					&& contenido(Datos[r][9],opcional1_seleccionadas)
				{% endif %}
				{%if Datos.0.proyecto.proyectosdatos.opcional2 %}
					&& contenido(Datos[r][10],opcional2_seleccionadas)
				{% endif %}
				{%if Datos.0.proyecto.proyectosdatos.opcional3 %}
					&& contenido(Datos[r][11],opcional3_seleccionadas)
				{% endif %}
				{%if Datos.0.proyecto.proyectosdatos.opcional4 %}
					&& contenido(Datos[r][12],opcional4_seleccionadas)
				{% endif %}
				{%if Datos.0.proyecto.proyectosdatos.opcional5 %}
					&& contenido(Datos[r][13],opcional5_seleccionadas)
				{% endif %}
			){
                    totalPersonasFiltro += 1;
					var puntaje = calculePuntaje(Datos[r][14],Datos[r][15],Datos[r][7]);

=======

	data2.addRows(dataTable);
	var altura = 260;
	{%if Datos.0.proyecto.proyectosdatos.opcional1 %}altura+=40;{% endif %}
	{%if Datos.0.proyecto.proyectosdatos.opcional2 %}altura+=40;{% endif %}
	{%if Datos.0.proyecto.proyectosdatos.opcional3 %}altura+=40;{% endif %}
	{%if Datos.0.proyecto.proyectosdatos.opcional4 %}altura+=40;{% endif %}
	{%if Datos.0.proyecto.proyectosdatos.opcional5 %}altura+=40;{% endif %}

	var options = {   height: altura, };
	var chart = new google.visualization.ColumnChart(document.getElementById('grafica_dos_div'));
	chart.draw(data2, options);


},
dataTab2: function(fechaInicial,fechaFinal){
	var {%if Datos.0.proyecto.proyectosdatos.opcional1 %}opcional1_seleccionadas = $op1_g3.val() || [],{% endif %}
		{%if Datos.0.proyecto.proyectosdatos.opcional2 %}opcional2_seleccionadas = $op2_g3.val() || [],{% endif %}
		{%if Datos.0.proyecto.proyectosdatos.opcional3 %}opcional3_seleccionadas = $op3_g3.val() || [],{% endif %}
		{%if Datos.0.proyecto.proyectosdatos.opcional4 %}opcional4_seleccionadas = $op4_g3.val() || [],{% endif %}
		{%if Datos.0.proyecto.proyectosdatos.opcional5 %}opcional5_seleccionadas = $op5_g3.val() || [],{% endif %}
		variables_seleccionadas = $var_g2.val() || [],
		regionales_seleccionadas = $reg_g2.val() || [],
		ciudades_seleccionadas = $ciu_g2.val() || [],
		areas_seleccionadas = $are_g2.val() || [],
 		cargos_seleccionados = $car_g2.val() || [];

		var matrizTotal= [], variables = [];
		var puntajeVariables = [], indiceVariables = [];

		for(z=0;z<Datos.length;z++){
			if(Datos[z][16]=='True'){
		                var puntajePendejo = calculePuntaje(Datos[z][14],Datos[z][15],Datos[z][7]);
						if(!contenido(Datos[z][14],indiceVariables)){
							puntajeVariables.push(puntajePendejo);
							indiceVariables.push(Datos[z][14]);
						  }else{
								var ind1 = indiceVariables.indexOf(Datos[z][14]);
								puntajeVariables[ind1] += puntajePendejo;
							}
			}
		}

		for(r=0;r<Datos.length;r++){
            if(
				fechaInicial<=Datos[r][8].getTime()
				&&Datos[r][8].getTime()<=fechaFinal
				&& contenido(Datos[r][14],variables_seleccionadas)
				&& Datos[r][16] == "True"
				&& contenido(Datos[r][3],regionales_seleccionadas)
				&& contenido(Datos[r][4],ciudades_seleccionadas)
				&& contenido(Datos[r][5],areas_seleccionadas)
				&& contenido(Datos[r][6],cargos_seleccionados)
				{%if Datos.0.proyecto.proyectosdatos.opcional1 %}
					&& contenido(Datos[r][9],opcional1_seleccionadas)
				{% endif %}
				{%if Datos.0.proyecto.proyectosdatos.opcional2 %}
					&& contenido(Datos[r][10],opcional2_seleccionadas)
				{% endif %}
				{%if Datos.0.proyecto.proyectosdatos.opcional3 %}
					&& contenido(Datos[r][11],opcional3_seleccionadas)
				{% endif %}
				{%if Datos.0.proyecto.proyectosdatos.opcional4 %}
					&& contenido(Datos[r][12],opcional4_seleccionadas)
				{% endif %}
				{%if Datos.0.proyecto.proyectosdatos.opcional5 %}
					&& contenido(Datos[r][13],opcional5_seleccionadas)
				{% endif %}
			){

					var puntaje = calculePuntaje(Datos[r][14],Datos[r][15],Datos[r][7]);
>>>>>>> 964182998135a4b410c67302f266c4c9ecbf6523
					if(!contenido(Datos[r][14],variables)){
                        // var ind2 = indiceVariables.indexOf(Datos[i][14]);
						matrizTotal.push([Datos[r][1],puntajeVariables[indiceVariables.indexOf(Datos[r][14])],puntaje]);
						variables.push(Datos[r][14]);

					}else{
						var ind = variables.indexOf(Datos[r][14]);
						matrizTotal[ind][2] += puntaje;
					}
			}



		}
<<<<<<< HEAD
        for(h=0;h<matrizTotal.length;h++){
			matrizTotal[h][2] = matrizTotal[h][2]/totalPersonasFiltro; 
		}
=======

>>>>>>> 964182998135a4b410c67302f266c4c9ecbf6523
return matrizTotal
console.log(matrizTotal);
},

	//==============================================================================
	//   Grafica TRES
	//==============================================================================
grafica_tres:  function(dataTable){
	var paila = dataTable;
    var data2 = new google.visualization.DataTable();
	data2.addColumn('string','Nombre');
    data2.addColumn('number','Puntaje');

	data2.addRows(dataTable);
	var altura = 260;
	{%if Datos.0.proyecto.proyectosdatos.opcional1 %}altura+=40;{% endif %}
	{%if Datos.0.proyecto.proyectosdatos.opcional2 %}altura+=40;{% endif %}
	{%if Datos.0.proyecto.proyectosdatos.opcional3 %}altura+=40;{% endif %}
	{%if Datos.0.proyecto.proyectosdatos.opcional4 %}altura+=40;{% endif %}
	{%if Datos.0.proyecto.proyectosdatos.opcional5 %}altura+=40;{% endif %}

	var options = {   height: altura,
					  legend: {position: 'top', maxLines: 1,'alignment':'center'},
	};
	var chart = new google.visualization.Histogram(document.getElementById('grafica_tres_div'));
	chart.draw(data2, options);

	     },

dataTab3: function(tiempoInicial,tiempoFinal){
	var {%if Datos.0.proyecto.proyectosdatos.opcional1 %}opcional1_seleccionadas = $op1_g3.val() || [],{% endif %}
		{%if Datos.0.proyecto.proyectosdatos.opcional2 %}opcional2_seleccionadas = $op2_g3.val() || [],{% endif %}
		{%if Datos.0.proyecto.proyectosdatos.opcional3 %}opcional3_seleccionadas = $op3_g3.val() || [],{% endif %}
		{%if Datos.0.proyecto.proyectosdatos.opcional4 %}opcional4_seleccionadas = $op4_g3.val() || [],{% endif %}
		{%if Datos.0.proyecto.proyectosdatos.opcional5 %}opcional5_seleccionadas = $op5_g3.val() || [],{% endif %}
		variables_seleccionadas = $var_g3.val(),
		preguntas_seleccionadas = $pre_g3.val() || [],
		regionales_seleccionadas = $reg_g3.val() || [],
		ciudades_seleccionadas = $ciu_g3.val() || [],
		areas_seleccionadas = $are_g3.val() || [],
		cargos_seleccionados = $car_g3.val() || [];

		var matrizDatos = [],personas = [];
		for(i=0;i<Datos.length;i++){
			if(
				tiempoInicial<=Datos[i][8].getTime()
				&&Datos[i][8].getTime()<=tiempoFinal
				&&Datos[i][14]==variables_seleccionadas
				&& Datos[i][16] == "True"
				&& contenido(Datos[i][15],preguntas_seleccionadas)
				&& contenido(Datos[i][3],regionales_seleccionadas)
				&& contenido(Datos[i][4],ciudades_seleccionadas)
				&& contenido(Datos[i][5],areas_seleccionadas)
				&& contenido(Datos[i][6],cargos_seleccionados)
				{%if Datos.0.proyecto.proyectosdatos.opcional1 %}
					&& contenido(Datos[i][9],opcional1_seleccionadas)
				{% endif %}
				{%if Datos.0.proyecto.proyectosdatos.opcional2 %}
					&& contenido(Datos[i][10],opcional2_seleccionadas)
				{% endif %}
				{%if Datos.0.proyecto.proyectosdatos.opcional3 %}
					&& contenido(Datos[i][11],opcional3_seleccionadas)
				{% endif %}
				{%if Datos.0.proyecto.proyectosdatos.opcional4 %}
					&& contenido(Datos[i][12],opcional4_seleccionadas)
				{% endif %}
				{%if Datos.0.proyecto.proyectosdatos.opcional5 %}
					&& contenido(Datos[i][13],opcional5_seleccionadas)
				{% endif %}

			){
						var puntaje = calculePuntaje(Datos[i][14],Datos[i][15],Datos[i][7])/preguntas_seleccionadas.length;
						if(!contenido(Datos[i][0],personas)){
							personas.push(Datos[i][0]);
							matrizDatos.push([Datos[i][0],puntaje]);
						}else{
							var ind = personas.indexOf(Datos[i][0]);
							matrizDatos[ind][1] += puntaje;
						}
				}
        	}

			return matrizDatos
			// fin funcion dataTab3

},

//==============================================================================
//   Fin de objeto
//==============================================================================
}

//==============================================================================
//   Control de mision
//==============================================================================
$(document).ready(function() {
	Elementos.inicio();
	google.load('visualization', '1', {packages:['controls'], callback: Elementos.grafica_uno});
	$('.panel-body').fadeTo('slow',100);
	$('.filtros_uno').change(function(){	Elementos.grafica_uno();});

    //  google.setOnLoadCallback(Elementos.grafica_dos());

	 var tiemposInicio_0 = tiemposIniciales(fechas);


    //   GRAFICA 2
     var dataTotal2 = Elementos.dataTab2(tiemposInicio_0[2],tiemposInicio_0[3]);
	 google.setOnLoadCallback(Elementos.grafica_dos(dataTotal2));
    //  INICIO SLIDER
	 $("#control_grafica_dos_div").dateRangeSlider({
 		bounds:{
 			min: new Date({{ Datos.0.proyecto.proyectosdatos.finicio.year }},{{ Datos.0.proyecto.proyectosdatos.finicio.month | add:-1 }},{{ Datos.0.proyecto.proyectosdatos.finicio.day }}),
 			max: new Date({{ Datos.0.proyecto.proyectosdatos.ffin.year }},{{ Datos.0.proyecto.proyectosdatos.ffin.month | add:-1 }},{{ Datos.0.proyecto.proyectosdatos.ffin.day }})
 		},
 		defaultValues:{
 			min: tiemposInicio_0[2],
 			max: tiemposInicio_0[3]
 		}
 	});


	$('#control_grafica_dos_div').on('valuesChanged',function(e,data){
		var tiempoMin = data.values.min.getTime(), tiempoMax = data.values.max.getTime();
		var espacio = Elementos.dataTab2(tiempoMin,tiempoMax);
		Elementos.grafica_dos(espacio);

	})

	$('.filtros_dos').change(function(){
       var fecha = $('#control_grafica_dos_div').dateRangeSlider('values');
       var dataFiltros= Elementos.dataTab2(fecha.min.getTime(),fecha.max.getTime());
	   Elementos.grafica_dos(dataFiltros);
	//    variables_seleccionadas = $var_g3.val();
	});


     ///GRAFICA 3

	var dataTotal = Elementos.dataTab3(tiemposInicio_0[2],tiemposInicio_0[3]);
	google.setOnLoadCallback(Elementos.grafica_tres(dataTotal));
	// INICIO SLIDER
	$("#control_grafica_tres_div").dateRangeSlider({
		bounds:{
			min: new Date({{ Datos.0.proyecto.proyectosdatos.finicio.year }},{{ Datos.0.proyecto.proyectosdatos.finicio.month | add:-1 }},{{ Datos.0.proyecto.proyectosdatos.finicio.day }}),
			max: new Date({{ Datos.0.proyecto.proyectosdatos.ffin.year }},{{ Datos.0.proyecto.proyectosdatos.ffin.month | add:-1 }},{{ Datos.0.proyecto.proyectosdatos.ffin.day }})
		},
		defaultValues:{
			min: tiemposInicio_0[2],
			max: tiemposInicio_0[3]
		}
	});

	$('#control_grafica_tres_div').on('valuesChanged',function(e,data){
		var tiempoMin = data.values.min.getTime(), tiempoMax = data.values.max.getTime();
		var espacio = Elementos.dataTab3(tiempoMin,tiempoMax);
		Elementos.grafica_tres(espacio);

	})

	$('.filtros_tres').change(function(){
       var fecha = $('#control_grafica_tres_div').dateRangeSlider('values');
       var dataFiltros= Elementos.dataTab3(fecha.min.getTime(),fecha.max.getTime());
	   Elementos.grafica_tres(dataFiltros);
	   variables_seleccionadas = $var_g3.val();
	});


	$(window).resize(function() {
		Elementos.grafica_uno();
	});


});
</script>
{%endblock%}
